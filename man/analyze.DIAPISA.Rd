% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analyze.DIAPISA.R
\name{analyze.DIAPISA}
\alias{analyze.DIAPISA}
\title{Differential Stability Analysis from DIA-NN Output}
\usage{
analyze.DIAPISA(
  file,
  extract.after = "^",
  extract.before = "_",
  ctrl.name = "Ctrl",
  pos.ctrl.name = NA,
  pos.ctrl.id = "PF3D7_0417200.1-p1",
  exclude = pos.ctrl.name,
  FC.cutoff = c(1.2, 1.2),
  p.cutoff = c(0.01, 0.05),
  p.adjust = "BH",
  compare.to.all = FALSE,
  pulses = 1,
  pulse.quant = "prot.max",
  report.quant.col = "Genes.MaxLFQ.Unique",
  export.xic = FALSE,
  xic.folder = "report_xic"
)
}
\arguments{
\item{file}{Path to the DIA-NN \code{.parquet} report file.}

\item{extract.after}{Regex pattern to extract group names from sample names (after a specific pattern).}

\item{extract.before}{Regex pattern to extract group names from sample names (before a specific pattern).}

\item{ctrl.name}{Name of the control group (e.g., "Ctrl").}

\item{pos.ctrl.name}{Regex pattern to extract the positive control sample.}

\item{pos.ctrl.id}{ID of the protein that is the hit in the positive sample.}

\item{exclude}{Vector of patterns, which will be matched to samples and those will be excluded from the analysis.}

\item{FC.cutoff}{Fold change cutoff for determining significance for hits (first value) and candidates (second value) (default is c(1.2,1.2)).}

\item{p.cutoff}{Adjusted p-value cutoff for determining significance for hits (first value) and candidates (second value) (default is c(0.01,0.05)).}

\item{p.adjust}{p-value adjustment method in limma::topTable}

\item{compare.to.all}{If TRUE, one treatment will be compared not only to the control sample but to all other treatment groups. Default is FALSE.}

\item{pulses}{In how many gas fractions were the samples measured?}

\item{pulse.quant}{Quantification method for GPF. "pept" is based on maximum peptide intensity, "prot.max" maximum protein intensity and "prot.mean" mean protein intensity.}

\item{report.quant.col}{Column in the report that contains quantification values. Either Genes.MaxLFQ.Unique or PG.MaxLFQ}

\item{export.xic}{Logical. Should the XIC of the hit proteins be plotted? This takes additional time (5-10s per hit).}

\item{xic.folder}{Folder in which the \code{xic.parquet} files are saved.}
}
\value{
A named list with the following elements:
\describe{
\item{all_results}{A data frame of differential analysis results.}
\item{volcano_facet}{A \code{ggplot} object showing faceted volcano plots.}
\item{volcano_list}{A named list of individual volcano plots per contrast.}
\item{MD_plot_faceted}{A \code{ggplot} object showing faceted MD plots.}
}
}
\description{
This function performs differential stability analysis on protein abundance data from a DIA-NN \code{.parquet} file.
It uses the \code{limma} package to compute moderated statistics, generates volcano plots, and MD plots.
}
\details{
The implementation is heavily inspired by code from the limma-for-proteomics
GitHub repository: \url{https://github.com/41ison/limma-for-proteomics}
}
\examples{
\dontrun{
result <- analyze_stability_from_parquet(
  file = "data/report.parquet",
  extract.after = "DIA_",
  extract.before = "_Rep",
  ctrl.name = "Ctrl",
  FC.cutoff = 1.5,
  p.cutoff = 0.01
)
result$all_results
result$volcano_facet
}
}
